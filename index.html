<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimal-ui">
    <title>Hancock Dlt Broker</title>
    <link type="text/css" rel="stylesheet" href="assets/css/github-markdown.css">
    <link type="text/css" rel="stylesheet" href="assets/css/pilcrow.css">
    <link type="text/css" rel="stylesheet" href="assets/css/hljs-github.min.css"/>
  </head>
  <body>
    <article class="markdown-body"><h1 id="hancock-dlt-broker"><a class="header-link" href="#hancock-dlt-broker"></a>Hancock Dlt Broker</h1>
<p>Microservice belonging to Hancock&#39;s ecosystem which creates a subscription to the blockchain 
watching for events related with some addresses or smart contracts</p>
<h3 id="current-blockchains-supported"><a class="header-link" href="#current-blockchains-supported"></a>Current blockchains supported</h3>
<ul class="list">
<li>Ethereum</li>
</ul>
<h3 id="building-the-service"><a class="header-link" href="#building-the-service"></a>Building the service</h3>
<p>Clone the project:</p>
<pre class="hljs"><code>  <span class="hljs-comment"># Clone the project </span>
  git <span class="hljs-built_in">clone</span> https://github.com/BBVA/hancock-dlt-broker.git
  <span class="hljs-built_in">cd</span> kst-hancock-ms-dlt-broker</code></pre><p>With node and npm or yarn:</p>
<pre class="hljs"><code>  <span class="hljs-comment"># With npm</span>
  npm install
  npm run build:ts
  npm run serve:prod

  <span class="hljs-comment"># With yarn</span>
  yarn install
  yarn run build:ts
  yarn run serve:prod</code></pre><p>With <a href="https://www.docker.com/">docker</a>:</p>
<pre class="hljs"><code>  <span class="hljs-comment"># Build the docker image</span>
  docker build -t hancock_dlt_broker .

  <span class="hljs-comment"># Run the docker container</span>
  docker run <span class="hljs-_">-d</span> -it --name -p 80:80 hancock_dlt_broker_container hancock_dlt_broker</code></pre><h3 id="setting-up-the-service"><a class="header-link" href="#setting-up-the-service"></a>Setting up the service</h3>
<p>Once we have built the service, we need to configure a few things before launch it. You can find all environment vars 
availables to configure the service in <code>config/custom-environment-variables.yaml</code>.</p>
<p>An example of configuration of the most important vars:</p>
<ul class="list">
<li><p>Ethereum rpc node:</p>
<pre class="hljs"><code><span class="hljs-built_in">export</span> HANCOCK_BLOCKCHAIN_ETHEREUM_PROTOCOL=<span class="hljs-string">"http"</span>
<span class="hljs-built_in">export</span> HANCOCK_BLOCKCHAIN_ETHEREUM_HOST=<span class="hljs-string">"52.80.128.77"</span>
<span class="hljs-built_in">export</span> HANCOCK_BLOCKCHAIN_ETHEREUM_PORT=<span class="hljs-string">"34774"</span></code></pre></li>
<li><p>Mongo ddbb host:</p>
<pre class="hljs"><code><span class="hljs-built_in">export</span> HANCOCK_DB_HOSTS=<span class="hljs-string">"localhost:27017"</span>
<span class="hljs-built_in">export</span> HANCOCK_DB_DATABASE=<span class="hljs-string">"hancock"</span>
<span class="hljs-built_in">export</span> HANCOCK_DB_ETHEREUM_DATABASE=<span class="hljs-string">"hancock_eth"</span></code></pre></li>
</ul>
<h3 id="using-the-service"><a class="header-link" href="#using-the-service"></a>Using the service</h3>
<p>The hancock broker service is accessible by an standard web socket interface. You can test it in a browser console, as follows:</p>
<pre class="hljs"><code><span class="hljs-keyword">let</span> address = <span class="hljs-string">"0xd2Bb4b9C30DE543C2a247E818391F37A98E62D3F"</span>;
<span class="hljs-keyword">let</span> sender = <span class="hljs-string">"0xF0fF42D561124786be9902206a758cDeE6f3D271"</span>;

ws = <span class="hljs-keyword">new</span> WebSocket(<span class="hljs-string">`ws://localhost:3009/ethereum/subscribe?address=<span class="hljs-subst">${address}</span>&amp;sender=<span class="hljs-subst">${sender}</span>`</span>)</code></pre><h3 id="async-api-docs"><a class="header-link" href="#async-api-docs"></a>Async API Docs</h3>
<p>Documentation about the async API can be found in this <a href="https://BBVA.github.io/hancock-dlt-broker/docs/api.html">link</a></p>
<h3 id="contribution-guidelines"><a class="header-link" href="#contribution-guidelines"></a>Contribution guidelines</h3>
<p>If you are thinking in contribute to the project you should know that:</p>
<ul class="list">
<li><p>The code has been written following the <a href="https://8thlight.com/blog/uncle-bob/2012/08/13/the-clean-architecture.html">clean architecture principles</a>, as well as <a href="https://es.wikipedia.org/wiki/SOLID">SOLID design principles</a>.</p>
</li>
<li><p>The project is built in <a href="https://www.typescriptlang.org/">typescript</a> v2.9.2 using the <a href="https://github.com/palantir/tslint/blob/master/src/configs/recommended.ts">recommended guidelines</a>. Also there is a linter rules configured to follow this guidelines, so you can search for a plugin for your favourite IDE to be warned about this linter errors.</p>
</li>
</ul>
    </article>
  </body>
</html>
